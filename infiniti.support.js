"use strict";

/*;
	@module-license:
		The MIT License (MIT)
		@mit-license

		Copyright (@c) 2017 Richeve Siodina Bebedor
		@email: richeve.bebedor@gmail.com

		Permission is hereby granted, free of charge, to any person obtaining a copy
		of this software and associated documentation files (the "Software"), to deal
		in the Software without restriction, including without limitation the rights
		to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
		copies of the Software, and to permit persons to whom the Software is
		furnished to do so, subject to the following conditions:

		The above copyright notice and this permission notice shall be included in all
		copies or substantial portions of the Software.

		THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
		IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
		FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
		AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
		LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
		OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
		SOFTWARE.
	@end-module-license

	@module-configuration:
		{
			"package": "infiniti",
			"path": "infiniti/infiniti.js",
			"file": "infiniti.js",
			"module": "infiniti",
			"author": "Richeve S. Bebedor",
			"contributors": [
				"John Lenon Maghanoy <johnlenonmaghanoy@gmail.com>"
			],
			"eMail": "richeve.bebedor@gmail.com",
			"repository": "https://github.com:volkovasystems/infiniti.git",
			"test": "infiniti-test.js",
			"global": true,
			"class": true,
		}
	@end-module-configuration

	@module-documentation:
		Take note that the time part is always in zero.
	@end-module-documentation

	@include:
		{
			"asea": "asea",
			"diatom": "diatom",
			"harden": "harden",
			"moment": "moment",
			"optfor": "optfor",
			"U200b": "u200b"
		}
	@end-include
*/

var asea = require("asea");
var clazof = require("clazof");
var diatom = require("diatom");
var doubt = require("doubt");
var harden = require("harden");
var moment = require("moment");
var optfor = require("optfor");
var protype = require("protype");
var U200b = require("u200b");

var Infiniti = diatom("Infiniti");

harden("now", function now() {
	return Infiniti().compact();
}, Infiniti);

Infiniti.prototype.toString = function toString() {
	return this.trueDate;
};

Infiniti.prototype.valueOf = function valueOf() {
	return this.trueDate;
};

Infiniti.prototype.initialize = function initialize(date) {
	if (doubt(date).ARRAY && protype(date[0], NUMBER) && protype(date[1], NUMBER) && date[0].toString().length == 17) {
		this.offset = date[1];

		this.date = moment.utc(date[0], "YYYYMMDDHH").minute(0).second(0).millisecond(0).utcOffset(this.offset);

		this.persist();
	} else if (protype(date, STRING) && date.length == 31 && /^\-[\d\u200b]{30}|^[\d\u200b]{31}$/.test(date)) {
		this.date = date;

		this.parse();
	} else if (protype(date, STRING) && date) {
		try {
			date = moment(date).minute(0).second(0).millisecond(0);

			if (date.isValid()) {
				this.initialize(date.toDate());
			} else {
				throw new Error("invalid format, " + arguments[0]);
			}
		} catch (error) {
			throw new Error("error encountered while parsing, " + error.message);
		}
	} else if (clazof(date, Date)) {
		this.date = moment(date).minute(0).second(0).millisecond(0);

		this.persist();
	} else {
		this.date = moment(new Date()).minute(0).second(0).millisecond(0);

		this.persist();
	}

	return this;
};

/*
	@method-documentation:
		This should be persisted on the machine where the timezone is persisted.

		It will save the true date in utc format + the machine timezone.
	@end-method-documentation
*/
Infiniti.prototype.persist = function persist() {
	if (this.trueDate) {
		return this.trueDate;
	}

	var date = this.date.toDate();

	var offset = this.offset || this.date.utcOffset();
	var polarity = offset / Math.abs(offset);

	var trueDate = U200b([polarity.toString().replace(/\d+/, "") || "0", date.getUTCFullYear(), ("0" + (date.getUTCMonth() + 1)).slice(-2), ("0" + date.getUTCDate()).slice(-2), ("0" + date.getUTCHours()).slice(-2), "00", "00", "000", ("000" + Math.abs(offset)).slice(-5)]).join();

	this.trueDate = trueDate;

	this.offset = offset;

	return trueDate;
};

/*;
	@method-documentation:
		Decompose true date to a moment object.
	@end-method-documentation
*/
Infiniti.prototype.parse = function parse() {
	var date = this.date;
	if (protype(this.date, STRING)) {
		date = U200b(this.date).separate();
	} else if (this.trueDate) {
		date = U200b(this.trueDate).separate();
	} else {
		throw new Error("date not specified");
	}

	var polarity = parseInt(date[0] + 1);

	this.offset = polarity * parseInt(date[8]);

	date = moment.utc().year(parseInt(date[1])).month(parseInt(date[2]) - 1).date(parseInt(date[3])).hour(parseInt(date[4])).minute(0).second(0).millisecond(0);

	//: This will set the timezone of the Date object to the machine timezone.
	this.date = date;

	this.persist();

	return this;
};

/*;
	@method-documentation:
		Relative date is the date applied with UTC offset.

		This will return the date in ISO8601 format.
			@code:YYYY-MM-DDTHH:00:00.000;

		Do not use this to reference true date.
	@end-method-documentation
*/
Infiniti.prototype.relativeDate = function relativeDate() {
	return this.date.utc().utcOffset(this.offset).format("YYYY-MM-DDTHH:mm:ss:SSS");
};

/*;
	@method-documentation:
		Real date is the date with no UTC offset applied.

		This will return the date in ISO8601
			@code:YYYY-MM-DDTHH:00:00.000;
	@end-method-documentation
*/
Infiniti.prototype.realDate = function realDate() {
	return this.date.utc().format("YYYY-MM-DDTHH:mm:ss:SSS");
};

/*;
	@method-documentation:
		Returns a simple human readable representation of date.

		Date will be relative.
	@end-method-documentation
*/
Infiniti.prototype.getDate = function getDate() {
	return this.date.utc().utcOffset(this.offset).format("MMMM DD, YYYY");
};

/*;
	@method-documentation:
		Returns a simple human readable representation of date.

		Date will be relative.

		Setting complete will append true date format.
	@end-method-documentation
*/
Infiniti.prototype.printDate = function printDate(separator, complete) {
	/*;
 	@meta-configuration:
 		{
 			"separator": "string",
 			"complete": "boolean"
 		}
 	@end-meta-configuration
 */

	separator = optfor(arguments, STRING);

	complete = optfor(arguments, BOOLEAN);

	if (!protype(separator, STRING)) {
		separator = " | ";
	}

	separator = separator || " | ";

	if (complete) {
		return [this.getDate(), this.trueDate].join(separator);
	} else {
		return this.getDate();
	}
};

/*;
	@method-documentation:
		Returns a numerical representation of true date in UTC.

		Time part is excluded except the hour.
	@end-method-documentation
*/
Infiniti.prototype.compact = function compact() {
	return [this.date.utc().format("YYYYMMDDHH"), this.offset].map(function onEachToken(token) {
		return parseInt(token.toString());
	});
};

module.exports = Infiniti;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZmluaXRpLmpzIl0sIm5hbWVzIjpbImFzZWEiLCJyZXF1aXJlIiwiY2xhem9mIiwiZGlhdG9tIiwiZG91YnQiLCJoYXJkZW4iLCJtb21lbnQiLCJvcHRmb3IiLCJwcm90eXBlIiwiVTIwMGIiLCJJbmZpbml0aSIsIm5vdyIsImNvbXBhY3QiLCJwcm90b3R5cGUiLCJ0b1N0cmluZyIsInRydWVEYXRlIiwidmFsdWVPZiIsImluaXRpYWxpemUiLCJkYXRlIiwiQVJSQVkiLCJOVU1CRVIiLCJsZW5ndGgiLCJvZmZzZXQiLCJ1dGMiLCJtaW51dGUiLCJzZWNvbmQiLCJtaWxsaXNlY29uZCIsInV0Y09mZnNldCIsInBlcnNpc3QiLCJTVFJJTkciLCJ0ZXN0IiwicGFyc2UiLCJpc1ZhbGlkIiwidG9EYXRlIiwiRXJyb3IiLCJhcmd1bWVudHMiLCJlcnJvciIsIm1lc3NhZ2UiLCJEYXRlIiwicG9sYXJpdHkiLCJNYXRoIiwiYWJzIiwicmVwbGFjZSIsImdldFVUQ0Z1bGxZZWFyIiwiZ2V0VVRDTW9udGgiLCJzbGljZSIsImdldFVUQ0RhdGUiLCJnZXRVVENIb3VycyIsImpvaW4iLCJzZXBhcmF0ZSIsInBhcnNlSW50IiwieWVhciIsIm1vbnRoIiwiaG91ciIsInJlbGF0aXZlRGF0ZSIsImZvcm1hdCIsInJlYWxEYXRlIiwiZ2V0RGF0ZSIsInByaW50RGF0ZSIsInNlcGFyYXRvciIsImNvbXBsZXRlIiwiQk9PTEVBTiIsIm1hcCIsIm9uRWFjaFRva2VuIiwidG9rZW4iLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQTZEQSxJQUFNQSxPQUFPQyxRQUFTLE1BQVQsQ0FBYjtBQUNBLElBQU1DLFNBQVNELFFBQVMsUUFBVCxDQUFmO0FBQ0EsSUFBTUUsU0FBU0YsUUFBUyxRQUFULENBQWY7QUFDQSxJQUFNRyxRQUFRSCxRQUFT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QTZCLFNBQVNBLE9BQVQsR0FBbUI7QUFDL0MsUUFBTyxDQUNOLEtBQUtNLElBQUwsQ0FBVUssR0FBVixHQUFpQmdDLE1BQWpCLENBQXlCLFlBQXpCLENBRE0sRUFFTixLQUFLakMsTUFGQyxFQUdMd0MsR0FISyxDQUdBLFNBQVNDLFdBQVQsQ0FBc0JDLEtBQXRCLEVBQTZCO0FBQ25DLFNBQU9kLFNBQVVjLE1BQU1sRCxRQUFOLEVBQVYsQ0FBUDtBQUNBLEVBTE0sQ0FBUDtBQU1BLENBUEQ7O0FBU0FtRCxPQUFPQyxPQUFQLEdBQWlCeEQsUUFBakIiLCJmaWxlIjoiaW5maW5pdGkuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuLyo7XG5cdEBtb2R1bGUtbGljZW5zZTpcblx0XHRUaGUgTUlUIExpY2Vuc2UgKE1JVClcblx0XHRAbWl0LWxpY2Vuc2VcblxuXHRcdENvcHlyaWdodCAoQGMpIDIwMTcgUmljaGV2ZSBTaW9kaW5hIEJlYmVkb3Jcblx0XHRAZW1haWw6IHJpY2hldmUuYmViZWRvckBnbWFpbC5jb21cblxuXHRcdFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcblx0XHRvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG5cdFx0aW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuXHRcdHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcblx0XHRjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcblx0XHRmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuXG5cdFx0VGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsXG5cdFx0Y29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuXHRcdFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1Jcblx0XHRJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcblx0XHRGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcblx0XHRBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG5cdFx0TElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcblx0XHRPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRVxuXHRcdFNPRlRXQVJFLlxuXHRAZW5kLW1vZHVsZS1saWNlbnNlXG5cblx0QG1vZHVsZS1jb25maWd1cmF0aW9uOlxuXHRcdHtcblx0XHRcdFwicGFja2FnZVwiOiBcImluZmluaXRpXCIsXG5cdFx0XHRcInBhdGhcIjogXCJpbmZpbml0aS9pbmZpbml0aS5qc1wiLFxuXHRcdFx0XCJmaWxlXCI6IFwiaW5maW5pdGkuanNcIixcblx0XHRcdFwibW9kdWxlXCI6IFwiaW5maW5pdGlcIixcblx0XHRcdFwiYXV0aG9yXCI6IFwiUmljaGV2ZSBTLiBCZWJlZG9yXCIsXG5cdFx0XHRcImNvbnRyaWJ1dG9yc1wiOiBbXG5cdFx0XHRcdFwiSm9obiBMZW5vbiBNYWdoYW5veSA8am9obmxlbm9ubWFnaGFub3lAZ21haWwuY29tPlwiXG5cdFx0XHRdLFxuXHRcdFx0XCJlTWFpbFwiOiBcInJpY2hldmUuYmViZWRvckBnbWFpbC5jb21cIixcblx0XHRcdFwicmVwb3NpdG9yeVwiOiBcImh0dHBzOi8vZ2l0aHViLmNvbTp2b2xrb3Zhc3lzdGVtcy9pbmZpbml0aS5naXRcIixcblx0XHRcdFwidGVzdFwiOiBcImluZmluaXRpLXRlc3QuanNcIixcblx0XHRcdFwiZ2xvYmFsXCI6IHRydWUsXG5cdFx0XHRcImNsYXNzXCI6IHRydWUsXG5cdFx0fVxuXHRAZW5kLW1vZHVsZS1jb25maWd1cmF0aW9uXG5cblx0QG1vZHVsZS1kb2N1bWVudGF0aW9uOlxuXHRcdFRha2Ugbm90ZSB0aGF0IHRoZSB0aW1lIHBhcnQgaXMgYWx3YXlzIGluIHplcm8uXG5cdEBlbmQtbW9kdWxlLWRvY3VtZW50YXRpb25cblxuXHRAaW5jbHVkZTpcblx0XHR7XG5cdFx0XHRcImFzZWFcIjogXCJhc2VhXCIsXG5cdFx0XHRcImRpYXRvbVwiOiBcImRpYXRvbVwiLFxuXHRcdFx0XCJoYXJkZW5cIjogXCJoYXJkZW5cIixcblx0XHRcdFwibW9tZW50XCI6IFwibW9tZW50XCIsXG5cdFx0XHRcIm9wdGZvclwiOiBcIm9wdGZvclwiLFxuXHRcdFx0XCJVMjAwYlwiOiBcInUyMDBiXCJcblx0XHR9XG5cdEBlbmQtaW5jbHVkZVxuKi9cblxuY29uc3QgYXNlYSA9IHJlcXVpcmUoIFwiYXNlYVwiICk7XG5jb25zdCBjbGF6b2YgPSByZXF1aXJlKCBcImNsYXpvZlwiICk7XG5jb25zdCBkaWF0b20gPSByZXF1aXJlKCBcImRpYXRvbVwiICk7XG5jb25zdCBkb3VidCA9IHJlcXVpcmUoIFwiZG91YnRcIiApO1xuY29uc3QgaGFyZGVuID0gcmVxdWlyZSggXCJoYXJkZW5cIiApO1xuY29uc3QgbW9tZW50ID0gcmVxdWlyZSggXCJtb21lbnRcIiApO1xuY29uc3Qgb3B0Zm9yID0gcmVxdWlyZSggXCJvcHRmb3JcIiApO1xuY29uc3QgcHJvdHlwZSA9IHJlcXVpcmUoIFwicHJvdHlwZVwiICk7XG5jb25zdCBVMjAwYiA9IHJlcXVpcmUoIFwidTIwMGJcIiApO1xuXG5jb25zdCBJbmZpbml0aSA9IGRpYXRvbSggXCJJbmZpbml0aVwiICk7XG5cbmhhcmRlbiggXCJub3dcIiwgZnVuY3Rpb24gbm93KCApe1xuXHRyZXR1cm4gSW5maW5pdGkoICkuY29tcGFjdCggKTtcbn0sIEluZmluaXRpICk7XG5cbkluZmluaXRpLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIHRvU3RyaW5nKCApe1xuXHRyZXR1cm4gdGhpcy50cnVlRGF0ZTtcbn07XG5cbkluZmluaXRpLnByb3RvdHlwZS52YWx1ZU9mID0gZnVuY3Rpb24gdmFsdWVPZiggKXtcblx0cmV0dXJuIHRoaXMudHJ1ZURhdGU7XG59O1xuXG5JbmZpbml0aS5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIGluaXRpYWxpemUoIGRhdGUgKXtcblx0aWYoIGRvdWJ0KCBkYXRlICkuQVJSQVkgJiZcblx0XHRwcm90eXBlKCBkYXRlWyAwIF0sIE5VTUJFUiApICYmXG5cdFx0cHJvdHlwZSggZGF0ZVsgMSBdLCBOVU1CRVIgKSAmJlxuXHRcdGRhdGVbIDAgXS50b1N0cmluZyggKS5sZW5ndGggPT0gMTcgKVxuXHR7XG5cdFx0dGhpcy5vZmZzZXQgPSBkYXRlWyAxIF07XG5cblx0XHR0aGlzLmRhdGUgPSBtb21lbnQudXRjKCBkYXRlWyAwIF0sIFwiWVlZWU1NRERISFwiIClcblx0XHRcdC5taW51dGUoIDAgKVxuXHRcdFx0LnNlY29uZCggMCApXG5cdFx0XHQubWlsbGlzZWNvbmQoIDAgKVxuXHRcdFx0LnV0Y09mZnNldCggdGhpcy5vZmZzZXQgKTtcblxuXHRcdHRoaXMucGVyc2lzdCggKTtcblxuXHR9ZWxzZSBpZiggcHJvdHlwZSggZGF0ZSwgU1RSSU5HICkgJiZcblx0XHRkYXRlLmxlbmd0aCA9PSAzMSAmJlxuXHRcdCggL15cXC1bXFxkXFx1MjAwYl17MzB9fF5bXFxkXFx1MjAwYl17MzF9JC8gKS50ZXN0KCBkYXRlICkgKVxuXHR7XG5cdFx0dGhpcy5kYXRlID0gZGF0ZTtcblxuXHRcdHRoaXMucGFyc2UoICk7XG5cblx0fWVsc2UgaWYoIHByb3R5cGUoIGRhdGUsIFNUUklORyApICYmXG5cdFx0ZGF0ZSApXG5cdHtcblx0XHR0cnl7XG5cdFx0XHRkYXRlID0gbW9tZW50KCBkYXRlIClcblx0XHRcdFx0Lm1pbnV0ZSggMCApXG5cdFx0XHRcdC5zZWNvbmQoIDAgKVxuXHRcdFx0XHQubWlsbGlzZWNvbmQoIDAgKTtcblxuXHRcdFx0aWYoIGRhdGUuaXNWYWxpZCggKSApe1xuXHRcdFx0XHR0aGlzLmluaXRpYWxpemUoIGRhdGUudG9EYXRlKCApICk7XG5cblx0XHRcdH1lbHNle1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoIFwiaW52YWxpZCBmb3JtYXQsIFwiICsgYXJndW1lbnRzWyAwIF0gKTtcblx0XHRcdH1cblxuXHRcdH1jYXRjaCggZXJyb3IgKXtcblx0XHRcdHRocm93IG5ldyBFcnJvciggXCJlcnJvciBlbmNvdW50ZXJlZCB3aGlsZSBwYXJzaW5nLCBcIiArIGVycm9yLm1lc3NhZ2UgKTtcblx0XHR9XG5cblx0fWVsc2UgaWYoIGNsYXpvZiggZGF0ZSwgRGF0ZSApICl7XG5cdFx0dGhpcy5kYXRlID0gbW9tZW50KCBkYXRlIClcblx0XHRcdC5taW51dGUoIDAgKVxuXHRcdFx0LnNlY29uZCggMCApXG5cdFx0XHQubWlsbGlzZWNvbmQoIDAgKTtcblxuXHRcdHRoaXMucGVyc2lzdCggKTtcblxuXHR9ZWxzZXtcblx0XHR0aGlzLmRhdGUgPSBtb21lbnQoIG5ldyBEYXRlKCApIClcblx0XHRcdC5taW51dGUoIDAgKVxuXHRcdFx0LnNlY29uZCggMCApXG5cdFx0XHQubWlsbGlzZWNvbmQoIDAgKTtcblxuXHRcdHRoaXMucGVyc2lzdCggKTtcblx0fVxuXG5cdHJldHVybiB0aGlzO1xufTtcblxuLypcblx0QG1ldGhvZC1kb2N1bWVudGF0aW9uOlxuXHRcdFRoaXMgc2hvdWxkIGJlIHBlcnNpc3RlZCBvbiB0aGUgbWFjaGluZSB3aGVyZSB0aGUgdGltZXpvbmUgaXMgcGVyc2lzdGVkLlxuXG5cdFx0SXQgd2lsbCBzYXZlIHRoZSB0cnVlIGRhdGUgaW4gdXRjIGZvcm1hdCArIHRoZSBtYWNoaW5lIHRpbWV6b25lLlxuXHRAZW5kLW1ldGhvZC1kb2N1bWVudGF0aW9uXG4qL1xuSW5maW5pdGkucHJvdG90eXBlLnBlcnNpc3QgPSBmdW5jdGlvbiBwZXJzaXN0KCApe1xuXHRpZiggdGhpcy50cnVlRGF0ZSApe1xuXHRcdHJldHVybiB0aGlzLnRydWVEYXRlO1xuXHR9XG5cblx0bGV0IGRhdGUgPSB0aGlzLmRhdGUudG9EYXRlKCApO1xuXG5cdGxldCBvZmZzZXQgPSB0aGlzLm9mZnNldCB8fCB0aGlzLmRhdGUudXRjT2Zmc2V0KCApO1xuXHRsZXQgcG9sYXJpdHkgPSBvZmZzZXQgLyBNYXRoLmFicyggb2Zmc2V0ICk7XG5cblx0bGV0IHRydWVEYXRlID0gVTIwMGIoIFtcblx0XHRwb2xhcml0eS50b1N0cmluZyggKS5yZXBsYWNlKCAvXFxkKy8sIFwiXCIgKSB8fCBcIjBcIixcblx0XHRkYXRlLmdldFVUQ0Z1bGxZZWFyKCApLFxuXHRcdCggXCIwXCIgKyAoIGRhdGUuZ2V0VVRDTW9udGgoICkgKyAxICkgKS5zbGljZSggLTIgKSxcblx0XHQoIFwiMFwiICsgKCBkYXRlLmdldFVUQ0RhdGUoICkgKSApLnNsaWNlKCAtMiApLFxuXHRcdCggXCIwXCIgKyAoIGRhdGUuZ2V0VVRDSG91cnMoICkgKSApLnNsaWNlKCAtMiApLFxuXHRcdFwiMDBcIixcblx0XHRcIjAwXCIsXG5cdFx0XCIwMDBcIixcblx0XHQoIFwiMDAwXCIgKyBNYXRoLmFicyggb2Zmc2V0ICkgKS5zbGljZSggLTUgKVxuXHRdICkuam9pbiggKTtcblxuXHR0aGlzLnRydWVEYXRlID0gdHJ1ZURhdGU7XG5cblx0dGhpcy5vZmZzZXQgPSBvZmZzZXQ7XG5cblx0cmV0dXJuIHRydWVEYXRlO1xufTtcblxuLyo7XG5cdEBtZXRob2QtZG9jdW1lbnRhdGlvbjpcblx0XHREZWNvbXBvc2UgdHJ1ZSBkYXRlIHRvIGEgbW9tZW50IG9iamVjdC5cblx0QGVuZC1tZXRob2QtZG9jdW1lbnRhdGlvblxuKi9cbkluZmluaXRpLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIHBhcnNlKCApe1xuXHRsZXQgZGF0ZSA9IHRoaXMuZGF0ZTtcblx0aWYoIHByb3R5cGUoIHRoaXMuZGF0ZSwgU1RSSU5HICkgKXtcblx0XHRkYXRlID0gVTIwMGIoIHRoaXMuZGF0ZSApLnNlcGFyYXRlKCApO1xuXG5cdH1lbHNlIGlmKCB0aGlzLnRydWVEYXRlICl7XG5cdFx0ZGF0ZSA9IFUyMDBiKCB0aGlzLnRydWVEYXRlICkuc2VwYXJhdGUoICk7XG5cblx0fWVsc2V7XG5cdFx0dGhyb3cgbmV3IEVycm9yKCBcImRhdGUgbm90IHNwZWNpZmllZFwiICk7XG5cdH1cblxuXHRsZXQgcG9sYXJpdHkgPSBwYXJzZUludCggZGF0ZVsgMCBdICsgMSApO1xuXG5cdHRoaXMub2Zmc2V0ID0gcG9sYXJpdHkgKiBwYXJzZUludCggZGF0ZVsgOCBdICk7XG5cblx0ZGF0ZSA9IG1vbWVudC51dGMoIClcblx0XHQueWVhciggcGFyc2VJbnQoIGRhdGVbIDEgXSApIClcblx0XHQubW9udGgoIHBhcnNlSW50KCBkYXRlWyAyIF0gKSAtIDEgKVxuXHRcdC5kYXRlKCBwYXJzZUludCggZGF0ZVsgMyBdICkgKVxuXHRcdC5ob3VyKCBwYXJzZUludCggZGF0ZVsgNCBdICkgKVxuXHRcdC5taW51dGUoIDAgKVxuXHRcdC5zZWNvbmQoIDAgKVxuXHRcdC5taWxsaXNlY29uZCggMCApO1xuXG5cdC8vOiBUaGlzIHdpbGwgc2V0IHRoZSB0aW1lem9uZSBvZiB0aGUgRGF0ZSBvYmplY3QgdG8gdGhlIG1hY2hpbmUgdGltZXpvbmUuXG5cdHRoaXMuZGF0ZSA9IGRhdGU7XG5cblx0dGhpcy5wZXJzaXN0KCApO1xuXG5cdHJldHVybiB0aGlzO1xufTtcblxuLyo7XG5cdEBtZXRob2QtZG9jdW1lbnRhdGlvbjpcblx0XHRSZWxhdGl2ZSBkYXRlIGlzIHRoZSBkYXRlIGFwcGxpZWQgd2l0aCBVVEMgb2Zmc2V0LlxuXG5cdFx0VGhpcyB3aWxsIHJldHVybiB0aGUgZGF0ZSBpbiBJU084NjAxIGZvcm1hdC5cblx0XHRcdEBjb2RlOllZWVktTU0tRERUSEg6MDA6MDAuMDAwO1xuXG5cdFx0RG8gbm90IHVzZSB0aGlzIHRvIHJlZmVyZW5jZSB0cnVlIGRhdGUuXG5cdEBlbmQtbWV0aG9kLWRvY3VtZW50YXRpb25cbiovXG5JbmZpbml0aS5wcm90b3R5cGUucmVsYXRpdmVEYXRlID0gZnVuY3Rpb24gcmVsYXRpdmVEYXRlKCApe1xuXHRyZXR1cm4gdGhpcy5kYXRlLnV0YyggKS51dGNPZmZzZXQoIHRoaXMub2Zmc2V0ICkuZm9ybWF0KCBcIllZWVktTU0tRERUSEg6bW06c3M6U1NTXCIgKTtcbn07XG5cbi8qO1xuXHRAbWV0aG9kLWRvY3VtZW50YXRpb246XG5cdFx0UmVhbCBkYXRlIGlzIHRoZSBkYXRlIHdpdGggbm8gVVRDIG9mZnNldCBhcHBsaWVkLlxuXG5cdFx0VGhpcyB3aWxsIHJldHVybiB0aGUgZGF0ZSBpbiBJU084NjAxXG5cdFx0XHRAY29kZTpZWVlZLU1NLUREVEhIOjAwOjAwLjAwMDtcblx0QGVuZC1tZXRob2QtZG9jdW1lbnRhdGlvblxuKi9cbkluZmluaXRpLnByb3RvdHlwZS5yZWFsRGF0ZSA9IGZ1bmN0aW9uIHJlYWxEYXRlKCApe1xuXHRyZXR1cm4gdGhpcy5kYXRlLnV0YyggKS5mb3JtYXQoIFwiWVlZWS1NTS1ERFRISDptbTpzczpTU1NcIiApO1xufTtcblxuLyo7XG5cdEBtZXRob2QtZG9jdW1lbnRhdGlvbjpcblx0XHRSZXR1cm5zIGEgc2ltcGxlIGh1bWFuIHJlYWRhYmxlIHJlcHJlc2VudGF0aW9uIG9mIGRhdGUuXG5cblx0XHREYXRlIHdpbGwgYmUgcmVsYXRpdmUuXG5cdEBlbmQtbWV0aG9kLWRvY3VtZW50YXRpb25cbiovXG5JbmZpbml0aS5wcm90b3R5cGUuZ2V0RGF0ZSA9IGZ1bmN0aW9uIGdldERhdGUoICl7XG5cdHJldHVybiB0aGlzLmRhdGUudXRjKCApLnV0Y09mZnNldCggdGhpcy5vZmZzZXQgKS5mb3JtYXQoIFwiTU1NTSBERCwgWVlZWVwiICk7XG59O1xuXG4vKjtcblx0QG1ldGhvZC1kb2N1bWVudGF0aW9uOlxuXHRcdFJldHVybnMgYSBzaW1wbGUgaHVtYW4gcmVhZGFibGUgcmVwcmVzZW50YXRpb24gb2YgZGF0ZS5cblxuXHRcdERhdGUgd2lsbCBiZSByZWxhdGl2ZS5cblxuXHRcdFNldHRpbmcgY29tcGxldGUgd2lsbCBhcHBlbmQgdHJ1ZSBkYXRlIGZvcm1hdC5cblx0QGVuZC1tZXRob2QtZG9jdW1lbnRhdGlvblxuKi9cbkluZmluaXRpLnByb3RvdHlwZS5wcmludERhdGUgPSBmdW5jdGlvbiBwcmludERhdGUoIHNlcGFyYXRvciwgY29tcGxldGUgKXtcblx0Lyo7XG5cdFx0QG1ldGEtY29uZmlndXJhdGlvbjpcblx0XHRcdHtcblx0XHRcdFx0XCJzZXBhcmF0b3JcIjogXCJzdHJpbmdcIixcblx0XHRcdFx0XCJjb21wbGV0ZVwiOiBcImJvb2xlYW5cIlxuXHRcdFx0fVxuXHRcdEBlbmQtbWV0YS1jb25maWd1cmF0aW9uXG5cdCovXG5cblx0c2VwYXJhdG9yID0gb3B0Zm9yKCBhcmd1bWVudHMsIFNUUklORyApO1xuXG5cdGNvbXBsZXRlID0gb3B0Zm9yKCBhcmd1bWVudHMsIEJPT0xFQU4gKTtcblxuXHRpZiggIXByb3R5cGUoIHNlcGFyYXRvciwgU1RSSU5HICkgKXtcblx0XHRzZXBhcmF0b3IgPSBcIiB8IFwiO1xuXHR9XG5cblx0c2VwYXJhdG9yID0gc2VwYXJhdG9yIHx8IFwiIHwgXCI7XG5cblx0aWYoIGNvbXBsZXRlICl7XG5cdFx0cmV0dXJuIFsgdGhpcy5nZXREYXRlKCApLCB0aGlzLnRydWVEYXRlIF0uam9pbiggc2VwYXJhdG9yICk7XG5cblx0fWVsc2V7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0RGF0ZSggKTtcblx0fVxufTtcblxuLyo7XG5cdEBtZXRob2QtZG9jdW1lbnRhdGlvbjpcblx0XHRSZXR1cm5zIGEgbnVtZXJpY2FsIHJlcHJlc2VudGF0aW9uIG9mIHRydWUgZGF0ZSBpbiBVVEMuXG5cblx0XHRUaW1lIHBhcnQgaXMgZXhjbHVkZWQgZXhjZXB0IHRoZSBob3VyLlxuXHRAZW5kLW1ldGhvZC1kb2N1bWVudGF0aW9uXG4qL1xuSW5maW5pdGkucHJvdG90eXBlLmNvbXBhY3QgPSBmdW5jdGlvbiBjb21wYWN0KCApe1xuXHRyZXR1cm4gW1xuXHRcdHRoaXMuZGF0ZS51dGMoICkuZm9ybWF0KCBcIllZWVlNTURESEhcIiApLFxuXHRcdHRoaXMub2Zmc2V0XG5cdF0ubWFwKCBmdW5jdGlvbiBvbkVhY2hUb2tlbiggdG9rZW4gKXtcblx0XHRyZXR1cm4gcGFyc2VJbnQoIHRva2VuLnRvU3RyaW5nKCApICk7XG5cdH0gKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gSW5maW5pdGk7XG4iXX0=
